\chapter{Численный и теоретический анализ устойчивости нейронных сетей круговой
и линейной конфигураций с большим количеством нейронов} \label{chapter2}


\section{Введение во второй раздел}

Много работ посвящено проблеме устойчивости нейронных сетей, состоящих из двух 
нейронов (\cite{Yu&Cao_2007,Huang&Huang_2007}). В
работах~\cite{Campbell&Ruan&Wei_1999,Campbell&Yuan_2004} изучена проблема
устойчивости delayed  нейронной сети   круговой архитектуры. В настоящей 
статье мы  даем полное описание области  устойчивости в пространстве параметров
круговой системы нейронов. В отличие от
работ~\cite{Campbell&Ruan&Wei_1999,Campbell&Yuan_2004}, мы не вводим
запаздывание в selfconnection, зато рассматриваем  несимметричное взаимодействие
нейрона с правым и левым соседом. Мы изучаем также изменения в условиях
устойчивости, порожденные разрывом в круге. Еще одна особенность нашей работы -
рассмотрение  конфигураций  с неограниченным количеством нейронов. Методы
нашего исследования основаны на конусах устойчивости~\cite{Khokhlova&Kipnis&Malygina_2011}. 
Аналогичные методы применены в~\cite{Ivanov&Kipnis&Malygina_2011} для изучения
устойчивости дискретных моделей круговой системы нейронов (см. 
также~\cite{Kaslic&Balint_2009,Kipnis&Malygina_2011}).

Структура статьи такова. В разделе~\ref{sec:mainresults} мы описываем  модели и
указываем  основные результаты. Мы указываем область в пространстве параметров,
внутри которой обеспечена устойчивость нашей модели круговой системы нейронов 
при любом их количестве в круге. Если  параметры находятся вне этой области, то
при достаточно большом количестве нейронов в круге система неустойчива. В
разделе~\ref{sec:brokenring} показано, что разрыв связи в круге нейронов
способствует  устойчивости системы.   В разделе~\ref{sec:numericalmethods} мы 
описываем  численные методы, приводящие к  результатам разделов
\ref{sec:mainresults},~\ref{sec:brokenring}, в разделе~\ref{sec:proofs} даем
доказательства теорем. Мы используем метод конуса устойчивости
\cite{Khokhlova&Kipnis&Malygina_2011}.  В разделе~\ref{sec:discussion}  мы
обсуждаем результаты и намечаем направления дальнейших исследований. 

\section{Постановка задачи и основные результаты} \label{sec:mainresults}

Переход от нелинейных моделей нейронных сетей к линейным уравнениям посредством
линеаризации описан многократно. Для круговых соединений нейронов это сделано,
например,  в~\cite{Campbell&Ruan&Wei_1999,Campbell&Yuan_2004}. Поэтому мы
начнем сразу с линейной системы, к которой сводится изучение устойчивости
кругового соединения $n$ нейронов (рис.~\ref{fig:circle_of_neurons}) с двумя
запаздываниями:
\begin{equation}\label{maingeneral}
    \dot{x}_{j}(t) +  x_{j}(t) +  a\, x_{j-1}(t-\tau_1) + b\, x_{j+1}(t-\tau) = 0
    \qquad  (j\; {\rm{mod}}\; n).  
\end{equation}

\begin{figure}[ht]%\hspace*{1mm}
    \begin{center}
        \includegraphics[scale=0.4]{circle_of_neurons}
    \end{center}
    \caption{Круговая система нейронов}
    \label{fig:circle_of_neurons}
\end{figure}

Здесь $x_j$ $(1\leqslant j \leqslant n)$ сигнал $j$-го нейрона, действительные
коэффициенты $a$ и  $b$ характеризуют  интенсивности взаимодействия нейрона с
правым и левым соседними нейронами соответственно, $\tau_1$ и  $\tau$ суть
запаздывания во взаимодействии  нейрона с правым и левым соседними нейронами
соответственно. Общее аналитическое исследование устойчивости системы
\eqref{maingeneral} вряд ли возможно, поскольку даже  скалярное уравнение 
$\dot{x}(t) +  a\, x(t-\tau_1) + b\, x(t-\tau) = 0$ имеет, как выяснилось (см.
\cite{Kipnis&Levitskaya_2007,Levitskaya_2006}), очень сложную структуру области
устойчивости в пространстве параметров. Поэтому основными моделями в нашем
исследовании будут два  упрощенных варианта систем ~\eqref{maingeneral}, в
первом из которых $\tau_1=0$, во втором $\tau_1=\tau$:
\begin{equation}\label{main1}
    \dot{x}_{j}(t) +  x_{j}(t) +  a\, x_{j-1}(t) + b\, x_{j+1}(t-\tau) = 0 \qquad 
    (j\; {\rm{mod}}\; n),
\end{equation}
\begin{equation}\label{main2}
    \dot{x}_{j}(t) +  x_{j}(t) +  a\, x_{j-1}(t-\tau) + b\, x_{j+1}(t-\tau) = 0
    \qquad  (j\; {\rm{mod}}\; n).
\end{equation}
Уравнение ~\eqref{main1} соответствует малым запаздываниям взаимодействия
нейронов  с правыми соседними нейронами, а  ~\eqref{main2} --- близким 
запаздываниям взаимодействия нейронов  с правыми и левыми соседями. В обоих
уравнениях интенсивность взаимодействия нейронов с правыми и левыми соседями не
обязательно одинакова. Последнее свойство отличает нашу модель от модели работ
\cite{Campbell&Ruan&Wei_1999,Campbell&Yuan_2004}. Еще одно отличие в том, что у
нас отсутствует запаздывание в selfconnection.

Системы~\eqref{main1},~\eqref{main2} принадлежат классу систем вида 
\begin{equation}\label{generalequ}
    \dot{x}(t) +Ax(t)+ Bx(t-\tau)=0,    
\end{equation}
где $n\times n$ матрицы $A,B$ одновременно триангулируемы.  В
\cite{Khokhlova&Kipnis&Malygina_2011} указан метод диагностики устойчивости таких
систем с помощью конусов устойчивости.

Введем специальное обозначение для $n\times n$ матрицы оператора сдвига строк: 
\begin{equation}\label{matrixP}
P=
    \begin{pmatrix}
        0      &    0     &   \ldots &  0       &  1        \\
        1      &    0     &   \ldots &  0       &  0        \\
        0      &    1     &   \ldots &  0       &  0        \\
        \vdots &    \vdots&   \ddots &  \vdots  &  \vdots   \\
        0      &   0      &   \ldots &  1       &  0        \\
    \end{pmatrix}.
\end{equation}
В матричном виде уравнения~\eqref{main1},~\eqref{main2} соответственно будут
иметь вид
\begin{eqnarray}\label{mainmatrix1}
    \dot{x}(t) + (I+aP)\, x(t) +  bP^{n-1}\, x(t-\tau) = 0, \\
    \label{mainmatrix2}
    \dot{x}(t) + I\, x(t) + (aP+ bP^{n-1})\, x(t-\tau) = 0, 
\end{eqnarray}
где $I$ есть единичная $n\times n$ матрица, $x(t)=(x_1(t),\ldots , x_n(t))^T$.

В работе Mori и др.~\cite{Mori&Fukuma&Kuwahara_1981} доказано, что 
устойчивость уравнения~\eqref{generalequ}, независимая от запаздывания,
гарантирована при условии
\begin{equation}\label{mori}
    \min_{1\leqslant j \leqslant n}   \{\alpha_{jj}- \sum_{k=1,k\neq
    j}^{n}|\alpha_{jk}|\}> \max_{1\leqslant j \leqslant n}\sum_{k=1}^{n}
    |\beta_{jk}|,
\end{equation}
где $\alpha_{jk},\beta_{jk}$ суть элементы матриц $A,B$ соответственно. Отсюда
вытекает утверждение~\ref{prop:stab1}.

\begin{prop}\label{prop:stab1}
    Если  $|a|+|b|<1$, то системы~\eqref{matrixP},~\eqref{mainmatrix1} 
    и \eqref{matrixP}, \eqref{mainmatrix2} асимптотически устойчивы при любом
    $n$ и любом $\tau\geqslant 0$.
\end{prop}

\begin{theorem}\label{th:stab_with_great_n}
    Если $|a+b|>1$, то  системы~\eqref{matrixP},~\eqref{mainmatrix1} и
   \eqref{matrixP},~\eqref{mainmatrix2} неустойчивы при любом $\tau > 0$,
    если $n$ достаточно велико.
\end{theorem}

Доказательство теоремы~\ref{th:stab_with_great_n}  будет
дано в  разделе~\ref{sec:proofs}. Предложение~\ref{prop:stab1} и
теорема~\ref{th:stab_with_great_n} не дает информации о поведении систем
\eqref{matrixP},~\eqref{mainmatrix1} и~\eqref{matrixP},~\eqref{mainmatrix2} для
случая, когда выполнены одновременно неравенства $|a+b|<1$ и  $|a|+|b|>1$. Для
этого случая мы провели геометрические и численные эксперименты, методика 
которых описана в разделе~\ref{sec:numericalmethods}. Здесь мы представляем их
результаты.

На рисунках~\ref{fig:domain_no_delayright},~\ref{fig:domain_yes_delayright} 
показаны области $D_{\tau}$ в плоскости параметров $(a, b)$  для некоторых
значений~$\tau$. Область $D_{\tau}$ является расширением области, заданной
неравенством $|a|+|b|<1$, на северо-запад и юго-восток до границ, зависящих от
$\tau$. Если точка    $(a, b)$ лежит внутри  $D_{\tau}$ на Рис.
\ref{fig:domain_no_delayright}, то система~\eqref{matrixP},~\eqref{mainmatrix1}
асимптотически устойчива. Если  $(a, b)$ лежит вне   $D_{\tau}$ на 
рисунке~\ref{fig:domain_no_delayright}, то система~\eqref{matrixP},
\eqref{mainmatrix1} неустойчива при достаточно больших $n$. Аналогичные
утверждения верны для рисунка~\ref{fig:domain_yes_delayright} и системы
\eqref{matrixP}, ~\eqref{mainmatrix2}. Область $D_{\tau}$
центрально-симметрична: если $(a,b)\in D_{\tau}$, то $(-a,-b)\in D_{\tau}$.     
При одинаковых~$\tau$  область устойчивости для системы~\eqref{matrixP}, 
\eqref{mainmatrix1} шире области для~\eqref{matrixP},~\eqref{mainmatrix2}.         

\begin{figure}[ht]
    \centering
    \includegraphics[scale=1]{graph1}
    \caption{
        Области устойчивости  для системы~\eqref{matrixP},~\eqref{mainmatrix1}
        }
    \label{fig:domain_no_delayright}
\end{figure}
 
\begin{figure}[ht]
    \centering
    \includegraphics[scale=1]{graph2}
    \caption{
        Области устойчивости  для системы~\eqref{matrixP},~\eqref{mainmatrix2}
        }
    \label{fig:domain_yes_delayright}
\end{figure}

Для обеих систем  важна  прямая $a=-b$  в плоскости $(a, b)$, в окрестности
которой сконцентрированы точки устойчивости систем. Поэтому естественно
рассмотреть следующие две системы уравнений:
\begin{equation}\label{main1centereq}
    \dot{x}_{j}(t) +  x_{j}(t) +  a\, (x_{j-1}(t) - x_{j+1}(t-\tau)) = 0 \qquad
    (j\; {\rm{mod}}\; n),  
\end{equation}
\begin{equation}\label{main2centereq}
    \dot{x}_{j}(t) +  x_{j}(t) +  a\, (x_{j-1}(t-\tau) -  x_{j+1}(t-\tau)) = 0
    \qquad    (j\; {\rm{mod}}\; n).  
\end{equation}

\begin{determine}\label{det:bound_of_stability_for_big_n}
    Границей устойчивости системы~\eqref{main1centereq}  для больших $n$ назовем
    такое число $a_1(\tau)\in \mathbb{R}$, что если $|a|<a_1(\tau)$, то
   ~\eqref{main1centereq} устойчива при любом $n$, а если  $|a|>a_1(\tau)$, то
   ~\eqref{main1centereq}  неустойчива при всех достаточно больших $n$. Аналогично
    определим  $a_2(\tau)$ как границу устойчивости ~\eqref{main2centereq}  для
    больших $n$.
\end{determine}

В следующей таблице~\ref{tab:boundaries} представлены  результаты численных и
геометрических  экспериментов для систем~\eqref{main1centereq},
\eqref{main2centereq}.
%Для некоторых значений $\tau$ указаны граничные значения $a_1(\tau)$, такие что
% если  $|a|<a_1(\tau)$, то  система~\eqref{main1centereq}  асимптотически
% устойчива при любом $n$, а если  $|a|>a_1(\tau)$, то она неустойчива при
% достаточно больших $n$.   
%Аналогичное утверждение верно для  $a_2(\tau)$ и системы ~\eqref{main2centereq}. 
Очевидно, $\lim_{\tau\rightarrow \infty}a_1(\tau)\hm{=}\lim_{\tau\rightarrow
\infty}a_2(\tau)\hm{=}1/2$. 
Не столь очевидно поведение систем~\eqref{main1centereq},~\eqref{main2centereq}
при~$\tau\rightarrow 0$, которое рассматривается в следующей теореме.


\begin{theorem}\label{th:asymptotics_of_simm}
    \begin{equation}\label{evalasym}
        \lim_{\tau\rightarrow 0} a_1(\tau)\sqrt{2\tau}=\lim_{\tau\rightarrow 0}
        a_2(\tau)2\sqrt{\tau}=1.
    \end{equation}
\end{theorem}

Доказательство теоремы~\ref{th:asymptotics_of_simm} дано в
разделе~\ref{sec:proofs}. Таблица~\ref{tab:boundaries} подтверждает оценки
теоремы~\ref{th:asymptotics_of_simm}.  Действительно, согласно 
таблице~\ref{tab:boundaries},  при  $\tau=0.01$ имеем  
$a_1(\tau)\sqrt{2\tau}\simeq 1.0017$, $a_2(\tau)2\sqrt{\tau}\simeq 1.0033$.


\begin{table}[ht]
    \centering
    \caption{
        Границы областей устойчивости для систем~\eqref{main1centereq}, 
       ~\eqref{main2centereq}}
    \label{tab:boundaries}
    \begin{tabular}[t]{|l|ccccccccc|} 
    \hline
        {\footnotesize  $\tau$}         &   {\footnotesize 0.01}    &
        {\footnotesize  0.05}           &   {\footnotesize 0.1}     &
        {\footnotesize 0.2}             &   {\footnotesize 0.5}     &
        {\footnotesize 1}               &   {\footnotesize  2}      &
        {\footnotesize 3}               &   {\footnotesize 4}       \\  
        \hline 
        {\footnotesize $a_1(\tau)$}     &   {\footnotesize 7.0830}  &
        {\footnotesize 3.1901}          &   {\footnotesize 2.2742}  &
        {\footnotesize 1.6337}          &   {\footnotesize 1.0829}  &
        {\footnotesize 0.8229}          &   {\footnotesize 0.6597}  &
        {\footnotesize 0.5988}          &   {\footnotesize 0.5678}  \\
        {\footnotesize $a_2(\tau)$}     &   {\footnotesize 5.0166}  &
        {\footnotesize  2.2733 }        &   {\footnotesize 1.6337}  &
        {\footnotesize  1.1921 }        &   {\footnotesize 0.8226}  &
        {\footnotesize 0.6595 }         &   {\footnotesize 0.5678}  &
        {\footnotesize 0.5380}          &   {\footnotesize 0.5244} \\
        \hline
    \end{tabular}
\end{table}


\section{Разрыв в кольце} \label{sec:brokenring}
 
Выясним, что  происходит с устойчивостью, когда разорвана связь между, скажем,
первым и последним нейроном в  круговой сети нейронов 
(рисунок~\ref{fig:linear_neurons}).
 
\begin{figure}[ht] %\hspace*{1mm}
    \begin{center}
        \includegraphics[scale=0.4]{line_of_neurons}
    \end{center}
    \caption{Линейная система нейронов}
    \label{fig:linear_neurons}
\end{figure}

В этом случае аналог системы~\eqref{matrixP},~\eqref{mainmatrix1} описывается
уравнением~\eqref{generalequ} с матрицами~$A,B$, которые, вообще говоря, не
приводятся к одновременно к треугольному виду. Поэтому наш метод конусов
устойчивости непригоден для анализа устойчивости системы~\eqref{matrixP},
\eqref{mainmatrix1} с разорванной связью. Но для системы~\eqref{matrixP},
\eqref{mainmatrix2} он пригоден. Итак, рассмотрим следующий аналог системы
\eqref{matrixP},~\eqref{mainmatrix2}:
\begin{equation}
    \nonumber \dot{x}_{1}(t) +  x_{1}(t) +   b\, x_{2}(t-\tau) = 0,
\end{equation}
\begin{equation}
    \label{brokenequ} 
    \dot{x}_{j}(t) +  x_{j}(t) +  a\, x_{j-1}(t-\tau) + b\, x_{j+1}(t-\tau) = 0,
    \qquad  2\leqslant j\leqslant (n-1), 
\end{equation}
\begin{equation}
    \nonumber \dot{x}_{n}(t) +  x_{n}(t) +  a\, x_{n-1}(t-\tau)  = 0, \qquad
    n>2.
\end{equation}

Матричная форма уравнения~\eqref{brokenequ} такова:
\begin{equation}\label{matrixbrokenequ}
    \dot{x}(t) +I\,x(t)+ D\,x(t-\tau)=0,    
\end{equation}
где $n\times n$ матрица~$D$ имеет вид
\begin{equation}\label{matrixbroken}
    D=
    \begin{pmatrix}
        0       &   b       &   0       &   \ldots  &       0   &   0       \\
        a       &   0       &   b       &   \ldots  &       0   &   0       \\
        0       &   a       &   0       &   \ldots  &       0   &   0       \\
        \vdots  &   \vdots  &   \vdots  &   \ddots  &  \vdots   &  \vdots   \\
        0       &   0       &   0       &   \ldots  &       0   &   b       \\
        0       &   0       &   0       &   \ldots  &       a   &   0       \\
    \end{pmatrix}.
\end{equation}
Для формулировки следующей теоремы определим функцию $F(\tau)$ от запаздывания
$\tau\in (0,\infty)$: 
\begin{equation}
    \label{Ftau} 
    F(\tau)= \frac{1}{4\sin^2\omega},
\end{equation}
где $\omega$ есть наименьший положительный корень уравнения 
\begin{equation}
    \label{omegaboundary} 
    \tau= \omega \tan \omega.
\end{equation}

\begin{theorem}\label{th:domainbroken}
    Следующие утверждения верны.
    \begin{enumerate}
        \item Если  $|ab|<\frac {1}{4} $, то система ~\eqref{matrixbrokenequ},
            \eqref{matrixbroken} асимптотически устойчива при любом $n$ и любом
            $\tau\geqslant 0$.
        \item Если $ab> \frac {1}{4}$, то  система ~\eqref{matrixbrokenequ},
            \eqref{matrixbroken} неустойчива при любом $\tau\geqslant 0$, если
            $n$ достаточно велико. 
        \item Если  $ab<0$ и $|ab|<F(\tau)$, то система
            \eqref{matrixbrokenequ},~\eqref{matrixbroken} асимптотически
            устойчива при любом $n$.
        \item Если $ab<0$ и  $|ab|>F(\tau)$, то система~\eqref{matrixbrokenequ},
            \eqref{matrixbroken} неустойчива, если $n$ достаточно велико. 
    \end{enumerate}
\end{theorem}

Область delay-independent stability, очерченная пунктом~1 теоремы~\ref{th:domainbroken},
шире области~$|a| +|b|<1$, гарантированной достаточным условием~\eqref{mori}.

Доказательство теоремы~\ref{th:domainbroken}  дано в  разделе~\ref{sec:proofs}.
Результаты теоремы~\ref{th:domainbroken} отражены на рисунке~\ref{fig:domainbroken}.

\begin{figure}[ht]
    \centering
    \includegraphics[scale=1]{domain_for_line_of_neurons}
    \caption{
        Области  устойчивости для системы ~\eqref{matrixbrokenequ},
        \eqref{matrixbroken}} 
    \label{fig:domainbroken}
\end{figure}

Сравнивая рисунки~\ref{fig:domain_yes_delayright} и~\ref{fig:domainbroken}, мы
видим, что при разрыве кольца нейронов область устойчивости в пространстве
параметров  увеличивается.

Еще одно наблюдение: в системе~\eqref{matrixbrokenequ},~\eqref{matrixbroken} при
$a=0$ (или $b=0$) теорема~\ref{th:domainbroken} гарантирует delay-independent
устойчивость. В интерпретации это означает, что при разрыве круговой цепи
нейронов блокировка взаимодействия нейронов с правым (или левым) соседом
гарантирует устойчивость при любом запаздывании, что отнюдь неверно для
круговой конфигурации нейронов (см. п. 2 Теоремы 2 ???).

Рассмотрим вариант $a=-b$ в~\eqref{matrixbrokenequ},~\eqref{matrixbroken}.
Положим   $H(\tau)=\sqrt{F(\tau)}$ (см.~\eqref{Ftau},~\eqref{omegaboundary}).
Очевидно, $\lim_{\tau\rightarrow \infty}  H(\tau)= 1/2$ и $\lim_{\tau\rightarrow
0}  H(\tau) 2 \sqrt{\tau}=1$. В~системе~\eqref{matrixbrokenequ},
\eqref{matrixbroken}  с $a=-b$ функция $H(\tau)$ играет  роль границы
устойчивости,  аналогичную функции $a_2(\tau)$ для системы~\eqref{main2centereq}
(см. определение~\ref{det:bound_of_stability_for_big_n}). Сравнение поведения 
$H(\tau)$ с $a_2(\tau)$ (см. \eqref{evalasym}) показывает, что при $a=-b$ 
различия в условиях устойчивости для замкнутой и разорванной цепи нейронов невелики.



\section{Численные методы} \label{sec:numericalmethods}

%\textbf{Определение 2.}
\begin{determine}\label{det:conus_matrix}
    Конусом устойчивости для матричного уравнения~\eqref{generalequ}  мы
    называем поверхность в ${\mathbb{R}}^3$, образованную точками $M=(u_{1},
    u_{2}, u_{3})$, такими что
    
    \begin{equation}\label{cone}
        u_1+iu_2=(i\omega -h)\exp(-i\omega),     \qquad  u_3=h,
    \end{equation}
    где $h,\omega$ удовлетворяют неравенствам 
    \begin{equation}\label{homega}
        h\geqslant -\omega{/}\tan\omega, \quad   -\pi< \omega < \pi.
    \end{equation}
\end{determine}

Пусть матрицы $A,B$ приводятся одной трансформирующей матрицей к треугольным
формам $A_T, B_T$  с диагональными элементами  
$\lambda_j,\;\mu_j$ $(1\leqslant j \leqslant n)$ соответственно. Построим $n$
точек  $M_j=(u_{1j}, u_{2j}, u_{3j})\in {\mathbb{R}}^3$, так что 
\begin{equation}\label{generalpoints} 
    u_{1j}+iu_{2j} = \tau\mu_{j}\exp(i\tau\, {\rm{Im}}\,\lambda_{j}),  \qquad 
    u_{3j} = \tau \,{\rm{Re}}\, \lambda_{j},  \qquad 1\leqslant j \leqslant  n.                                           
\end{equation}
В силу результатов~\cite{Khokhlova&Kipnis&Malygina_2011}, система
\eqref{generalequ} асимптотически устойчива тогда и только тогда, когда все
точки $M_{j}$ $(1\leqslant j \leqslant n)$ лежат внутри конуса устойчивости. 
Если хотя бы одна из точек   $M_{j}$ лежит вне конуса, то~\eqref{generalequ}
неустойчива.

Программа~\cite{program2}, предназначенная для диагностирования устойчивости
системы ~\eqref{generalequ}, по  набору собственных чисел $\lambda_j,\; \mu_j$
возвращает объединение интервалов
\begin{equation}\label{stabintervals} 
    T = \cup_{k=1}^N (\tau_k , \, \tau_{k+1}),  
\end{equation}  
такое что если $\tau\in T$, то система~\eqref{generalequ}  асимптотически
устойчива, а если    $\tau\notin  [\tau_k , \, \tau_{k+1}]$ при любом $k$ 
$(1\leqslant k \leqslant N)$, то~\eqref{generalequ}  неустойчива.   

Для проверки устойчивости систем~\eqref{main1},~\eqref{main2} при неограниченном
порядке $n$  требуется модификация алгоритма, первоначально предназначенного для
общей системы~\eqref{generalequ}.   

Собственные числа матрицы $P$ суть $\lambda_j=\exp(i\frac{2\pi j}{n})$,
$1\leqslant j\leqslant n$. Поэтому при одновременном приведении четырех
циркулянтных матриц $(I+a\,P)$, $b\,P^{n-1}$, $I$, $a\,P+b\,P^{n-1}$  к
диагональному виду  их диагональные элементы равны соответственно

\begin{eqnarray}
    \label{lambdamu1}
    \lambda_{j}^{'} = 1+a\,\exp(i\frac{2\pi j}{n}), \quad   
    \mu_{j}^{'}= b\,\exp(-i\frac{2\pi j}{n}), \quad 
    1\leqslant j \leqslant n,\\
    \label{lambdamu2} 
    \lambda_{j}^{''} = 1, \quad 
    \mu_{j}^{''}=a\, \exp(i\frac{2\pi j}{n}) + b\, \exp(-i\frac{2\pi j}{n}), 
    \quad 1\leqslant j \leqslant n.
\end{eqnarray}
 
Для изучения устойчивости~\eqref{matrixP},~\eqref{mainmatrix1} строим систему
точек   $M_j^{'}= (u_{1j}^{'}, u_{2j}^{'}, u_{3j}^{'})  \in {\mathbb{R}}^3$,
определенных  равенствами (cм.~\eqref{generalpoints}, ~\eqref{lambdamu1})  
\begin{equation}\label{pointsmjmain1} 
    u_{1j}^{'}+iu_{2j}^{'}  =
        \tau b\,\exp(i(-\frac{2\pi j}{n}+a\tau\sin\frac{2\pi j}{n})),  \quad
    u_{3j}^{'}=\tau (1+a\cos \frac{2\pi j}{n}),  
    \quad  1\leqslant j \leqslant  n.                                             
\end{equation}
Аналогично, для системы~\eqref{matrixP},~\eqref{mainmatrix2} точки 
$M_j^{''}=(u_{1j}^{''}, u_{2j}^{''}, u_{3j}^{''})\in {\mathbb{R}}^3$, определены
равенствами (cм.~\eqref{generalpoints},~\eqref{lambdamu2}) 
\begin{equation}
    u_{1j}^{''}+iu_{2j}^{''} = 
    \tau a \,(\exp(i \frac{2\pi j}{n}) + b \exp(-i \frac{2\pi j}{n})), \quad
    u_{3j}^{''}         =\tau,   \quad 1\leqslant j \leqslant  n.         
\end{equation}
Для анализа систем~\eqref{matrixP},~\eqref{mainmatrix1} с большим $n$  вместо
дискретной системы точек $M_j$    естественно ввести непре\-рыв\-ную   замкнутую
кривую   $M^{'}(t)=(u_1^{'}(t), u_2^{'}(t), u_3^{'}(t))$, положив 
$t=\frac{2\pi j}{n}$ в~\eqref{pointsmjmain1}:  
\begin{equation}\label{curvemain1}
    u_{1}^{'}(t)+iu_{2}^{'}(t) = \tau b \,\exp(i(-t+a\, \tau\sin t)),  \quad
    u_{3}^{'}(t) = \tau (1+a\cos t),  \quad 0\leqslant t \leqslant 2\pi.                                  
\end{equation}
Аналогично, для~\eqref{matrixP}, ~\eqref{mainmatrix2} строим кривую
$M^{''}(t)=(u_1^{''}(t), u_2^{''}(t), u_3^{''}(t))$:
\begin{equation}\label{curvemain2}
    u_{1}^{''}(t)+iu_{2}^{''}(t)  = \tau (a \,\exp(it) +b \,\exp(-it) ),  \quad
    u_{3}^{''}(t) = \tau,   \quad 0\leqslant t \leqslant 2\pi.                                    
\end{equation}

При $n \rightarrow\infty$ точки $M_j$, определенные by~\eqref{pointsmjmain1}, 
образуют плотное на кривой~\eqref{curvemain1} множество. Поэтому  вопрос об
устойчивости системы ~\eqref{matrixP},~\eqref{mainmatrix1} сводится к
геометрической проблеме. Если все точки кривой~\eqref{curvemain1} лежат внутри
конуса устойчивости~\eqref{cone},~\eqref{homega}, то система~\eqref{matrixP},
\eqref{mainmatrix1} устойчива при любом $n$,  а если хотя бы одна точка кривой
\eqref{curvemain1} лежат вне конуса устойчивости,  то система~\eqref{matrixP},
\eqref{mainmatrix1} неустойчива при всех достаточно больших значениях $n$ 
(Рис.\ref{fig:stabcone}).

\begin{figure}[ht]
    \begin{center}
    \hspace*{-20mm}\includegraphics[scale=0.8]{cone_nice2}
    %{\hspace*{15mm} 
    \end{center}
    \caption{Конус устойчивости и две кривые~\eqref{curvemain1}. Одна кривая 
    для  $\tau = 1.5$,  $a = - 1.4$,  $b = 0.7$,  находится частично вне конуса
    устойчивости, следовательно, система~\eqref{matrixP},~\eqref{mainmatrix1} 
    неустойчива при достаточно больших $n$.  Вторая кривая  для  $\tau = 2$,  $a
    = 0.5$,  $b = -0.2$,  находится полностью  внутри конуса устойчивости,
    следовательно, система~\eqref{matrixP},~\eqref{mainmatrix1} устойчива при
    любом $n$.}      
    \label{fig:stabcone}
\end{figure}


В свою очередь, эта геометрическая задача решается численными методами. Для
системы~\eqref{matrixP},~\eqref{mainmatrix1} при различных значениях $t\in [0,2\pi]$   
мы вычисляем  $\arg(u^{'}_1(t)+ i u^{'}_2(t))$ согласно  ~\eqref{curvemain1} и
находим на конусе устойчивости на высоте $h=u^{'}_3(t)$  точку или две точки с
тем же аргументом. Сравнение модулей точек на кривой и конусе дает ответ на
вопрос, устойчива ли система~\eqref{matrixP}, ~\eqref{mainmatrix1}. Аналогично
изучается система~\eqref{matrixP},~\eqref{mainmatrix2}.

Программа, реализующая этот алгоритм, доступна в Интернете
\cite{program1}. С помощью этой программы мы строили границы области
устойчивости $D_{\tau}$ на Рисунках 2,3 и границы $a_1(\tau)$, $a_2(\tau)$ в
Таблице~\ref{tab:boundaries}.   


\section{Доказательства теорем } \label{sec:proofs} 

\subsection{Доказательство Теоремы 1} 

Докажем Теорему 1 с помощью конусов устойчивости
\cite{Khokhlova&Kipnis&Malygina_2011}. Начнем с системы~\eqref{matrixP},
\eqref{mainmatrix1}, эквивалентной~\eqref{main1}.   


%Cечение конуса устойчивости плоскостью $u_3={\rm{const}}$ есть так называемый
% овал устойчивости  
%\begin{equation}\label{oval}
%u_1+iu_2=(i\omega -u_3)\exp(-i\omega), \qquad  -\omega_1\leqslant \omega\leqslant \omega_1,
%\end{equation}
%где $\omega_1\in(0,\pi)$ является корнем уравнения 
%\begin{equation}\label{eqforomega1}
%\omega=  -u_3\tan \omega. 
%\end{equation}

Из ~\eqref{curvemain1} получим $u_{1}^{'}(\pi) = -\tau b$, $u_{3}^{'}(\pi) =\tau
(1-a)$ в противоречие с неравенством $u_1\geqslant -u_3$, верным на конусе
\eqref{cone},~\eqref{homega} и внутри него, и  неравенством $a+b>1$. Поэтому 
точка $M^{'}(\pi)$ находится вне конуса устойчивости, следовательно,
\eqref{matrixP},~\eqref{mainmatrix1} неустойчива при  достаточно больших  $n$.

Кривая~\eqref{curvemain1} переходит в себя при преобразовании 
$t \rightarrow t+\pi, a \rightarrow -a, b \rightarrow -b$, поэтому область
устойчивости системы~\eqref{matrixP},~\eqref{mainmatrix1}
центрально-симметрична. Следовательно, и  неравенство $a+b<-1$ обеспечивает
неустойчивость  системы~\eqref{matrixP},~\eqref{mainmatrix1}  при  достаточно
больших  $n$.

Аналогично, положив в~\eqref{curvemain2} $t=\pi/2$, докажем неустойчивость
\eqref{matrixP},~\eqref{mainmatrix2}   при  достаточно больших  $n$. Теорема 1
доказана.  

\subsection{Доказательство Теоремы ~\ref{th:asymptotics_of simm}}

1. Для выяснения асимптотики $a_1(\tau)$ требуется вычислить точки касания в
$\mathbb{R}^3$ конуса~\eqref{cone},~\eqref{homega}  с кривой~\eqref{curvemain1}
при $b=-a_1(\tau)$, $t=\pi/2$. На кривой~\eqref{curvemain1}

\begin{equation}\label{curvearg}
    \arg( u_{1}^{'}(t)+iu_2^{'}(t)) -\frac{\pi}{2} = \tau a_1(\tau). 
\end{equation}
Когда $\tau\rightarrow 0$, на конусе~\eqref{cone},~\eqref{homega}  при
$h=u_3(\pi/2)=\tau$
\begin{equation}\label{conearg}
    \arg( u_{1}+iu_2) -\frac{\pi}{2}= -\omega  +\arg(i\omega-\tau)- 
    \frac{\pi}{2} \sim  \frac{\tau}{\omega} -\omega.
\end{equation}
Здесь  $\alpha\sim \beta$ означает, что    $(\alpha/\beta)\rightarrow 1$.
Касание кривой и конуса влечет равенство аргументов ~\eqref{curvearg},
\eqref{conearg}, а также равенство модулей точек на кривой и конусе. Поэтому  
\begin{equation}\label{coneargequal}
    \tau a_1(\tau) \sim   \frac{\tau}{\omega} -\omega, \quad \tau a_1(\tau) =
    \sqrt{\omega^2+\tau^2}\sim \omega.
\end{equation}
Из~\eqref{coneargequal} получим $\omega \sim  \sqrt{\tau/2}$, что дает требуемую
оценку $ a_1(\tau) \sim   1/\sqrt{2\tau}$. 

2. Для выяснения асимптотики $a_2(\tau)$ положим в~\eqref{curvemain2}  
$b=-a=-a_2(\tau)$. Получим прямую
\begin{equation}\label{linemain2}
    u_{1}^{''}(t)=0, \quad 
    u_{2}^{''}(t)=2 \tau a_2(\tau) \sin t,  \quad
    u_3^{''}(t)=0, \quad
    0 \leqslant t \leqslant 2\pi.
\end{equation}
На конусе~\eqref{cone},~\eqref{homega} положим $u_3=\tau$, $u_1=0$. Получим 
$\omega^2\sim \tau$, поэтому  
\begin{equation}\label{asymmain2}
    u_{2}=\omega \cos \omega + \tau \sin \omega \sim \sqrt{\tau}.                                  
\end{equation}
Из ~\eqref{asymmain2} и ~\eqref{linemain2} при $t=\pi/2$
получим $a_2(\tau)\sim 1/(2\sqrt{\tau})$. Теорема~\ref{th:asymptotics_of simm}
доказана.


\subsection{Доказательство теоремы~\ref{th:domainbroken}}

Характеристический многочлен  $D_n(\mu)=|\mu\,I-D|$  удовлетворяет
соотно\-шениям
\begin{equation}\label{charpol}
    D_1(\mu)=\mu,\quad 
    D_2(\mu)=\mu^2 - ab,\quad  
    D_{n+2}(\mu)=\mu D_{n+1}(\mu)-ab \,D_{n}(\mu),\quad 
    n=1,2,\ldots
\end{equation}
Введем замену $y=\mu/\sqrt{ab}$ и новую последовательность функций $f_n(y)$:
\begin{equation}\label{fn}
    f_n(y)=\frac{1}{\sqrt{(ab)^n}}  D_n(y\sqrt{ab}).
\end{equation}
Тогда
\begin{equation}\label{frecur}
    f_1(y)=y,  \quad 
    f_2(y)=y^2 - 1,   \quad  
    f_{n+2}(y)=y f_{n+1}(y)-f_{n}(y), \quad 
    n=1,2,\ldots
\end{equation}
$f_n$ есть характеристический многочлен для симметрической матрицы $D$  с
$a=b=1$ (см.~\eqref{matrixbroken}), поэтому все его корни 
$y_{jn}$  $(1 \leqslant j \leqslant n)$ действительны. При четных $n$ полином
$f$ четен, при нечетных нечетен. Считая, что при фиксированном $n$ корни
$y_{jn}$ упорядочены по возрастанию, обозначим
\begin{equation}\label{maxmin}
    y_n^{*} = \max_{1\leqslant j \leqslant n} y_{jn} = y_{nn} = -y_{1n} =
    -\min_{1\leqslant j \leqslant n} y_{jn} = -y_n^{**}.
\end{equation}
\textbf{Лемма 1.} Для любого натурального $n$ 
\begin{eqnarray}\label{limf}
    -y_n^{**} =  y_n^{*}  <  y_{n+1}^{*}<2,  \quad 
    \lim_{n\rightarrow \infty} y_n^{*} =2, \quad
    \quad \lim_{n\rightarrow \infty} y_n^{**} =-2. 
\end{eqnarray}
\textbf{Доказательство}. 
Обозначим $\Delta f_n(y)=f_{n+1}(y)-f_n(y)$. Тогда рекуррентное соотношение
\eqref{frecur} перепишется как 
\begin{equation}\label{frecurdelta}
    \Delta f_{n+1}(y)=\Delta f_n(y)+(y-2)f_n(y).
\end{equation}
Из~\eqref{frecurdelta} следует, что $f_n(y)>0$ для всех $y\geqslant 2$, поэтому
$y_n^{*}<2$.  Индукцией по $n$ докажем, что $y_{n+1}^{*}> y_{n}^{*}$.
Действительно, для $n=1$ это верно. Пусть это верно для $n$. Тогда вследствие
\eqref{frecur} 
\begin{equation}\label{ineqfrecur}
    f_{n+2}(y_{n+1}^{*}) = -f_{n}( y_{n+1}^{*}) < f_{n}( y_{n}^{*}) = 0.   
\end{equation}
Ввиду $ f_{n+2}(2)>0$ получим, что существует некоторое $y> y_{n+1}^{*}$, такое
что $f_{n+2}(y)=0$. Значит, $y_{n+2}^{*}>y_{n+1}^{*}$, что и требовалось. Итак,
последовательность $(y_{n}^{*})$ монотонно возрастает и ограничена. Докажем, что
$\lim_{n\rightarrow \infty} y_{n}^{*}=2$. Предположим, для приведения к
противоречию, что существует такая левая полуокрестность $U$ числа 2, что
$f(y)>0$ для любого $y\in U$ и для любого $n$. Тогда ввиду ~\eqref{frecurdelta}
последовательность $(\Delta f_{n}(y))$ монотонно убывает. Неограниченность снизу
этой последовательности, разумеется, несовместима с положительностью   
$f_{n}(y)$. Поэтому существует предел  $\Delta f_{n}(y)$. Это ввиду
\eqref{frecurdelta} влечет $\lim_{n\rightarrow \infty}f_n(y)=0$, что влечет
$\lim_{n\rightarrow \infty} \Delta f_n(y)=0$. Но тогда вследствие монотонного
убывания  $(\Delta f_{n}(y))$  имеем $\Delta f_{n}(y)>0$ при любом $n$. Отсюда
следует монотонное возрастание $f_{n}(y)>0$ в противоречие с  
$\lim_{n\rightarrow \infty}f_n(y)=0$.
Следовательно, $\lim_{n\rightarrow \infty} y_{n}^{*}  =2$. Аналогичное
утверждение~\eqref{limf} о последовательности $(y_n^{**})$ следует из симметрии.
Лемма 1 доказана.

Продолжим доказательство Теоремы 3. Собственные числа $n\times n$ матриц $I,D$
равны соответственно 
\begin{equation}\label{lambdamubroken}
    \lambda_{jn}=1, \quad \mu_{jn} =  y_{jn} \sqrt{ ab},  \quad    
    1 \leqslant j \leqslant n.
\end{equation}
Если $|ab|<1/4$, то вследствие~\eqref{lambdamubroken} и~\eqref{maxmin},
\eqref{limf} при любом $n,j$
\begin{equation}\label{delayindbroken}
    \frac{|\mu_{jn}|}{\lambda_{jn}} =  |y_{jn}| \sqrt{ ab}<1,   
\end{equation}
что достаточно для асимптотической устойчивости, независимой от запаздывания
(см.~\cite{Khokhlova&Kipnis&Malygina_2011}). Пункт 1 Теоремы 3 доказан.

Для доказательства пунктов 2,3 Теоремы 3 построим точки  
$M_{jn}= (u_{1jn}, u_{2jn}, u_{3jn})  \in {\mathbb{R}}^3$  $(1\leqslant j
\leqslant  n)$, такие что (cм.~\eqref{lambdamubroken}) 
\begin{equation}\label{mjbroken} 
    u_{1jn}+iu_{2jn}  =\tau \mu_{jn} \exp(i\tau \Im \, 
    \lambda_{jn})=\tau y_{jn} \sqrt {ab}, \quad
    u_{3jn}= \tau \Re\lambda_{jn}        =\tau.                                             
\end{equation}

Пусть $ab>1/4$. Тогда по~\eqref{maxmin} и   Лемме 1       для любого $n$,
начиная с некоторого, $(-2)<y_{1n}<-1/\sqrt{ab}$, поэтому 
\begin{equation}\label{u2j} 
    u_{11n}  =\tau y_{1n}  \sqrt {ab} <-\tau.                                       
\end{equation} 
При этом $u_{21n}=0$,  $u_{31n}=\tau$. На поверхности и внутри конуса
устойчивости~\eqref{cone},~\eqref{homega} на высоте $u_3=\tau$ при $u_2=0$ имеем 
\begin{equation}\label{u2con} 
    u_{1} \geqslant - u_3 = - \tau.                                       
\end{equation} 
Сравнивая~\eqref{u2con} с ~\eqref{u2j}, выясняем, что точка $M_{1n}$, начиная с
некоторого $n$, лежит вне конуса устойчивости. Поэтому система 
\eqref{matrixbrokenequ},~\eqref{matrixbroken} неустойчива при достаточно больших
$n$. Пункт 2 Теоремы 3 доказан.

Из~\eqref{mjbroken} при $ab<0$ получим
\begin{equation}\label{mjbrokenpoints} 
    u_{1jn} =0, \quad u_{2jn}  =\tau y_{jn}\sqrt {|ab|}, \quad u_{3jn}=\tau.                                             
\end{equation}
В то же время на поверхности конуса устойчивости~\eqref{cone},~\eqref{homega} на
высоте $u_{3}=\tau$ при $u_{1}=0$  
\begin{equation}\label{u2conebroken} 
    u_{2} = \frac{\omega}{\cos\omega} ,                                              
\end{equation}  
где параметр $\omega$ ввиду $u_1=0$ удовлетворяет условию ~\eqref{omegaboundary}.
Теперь из ~\eqref{mjbrokenpoints},~\eqref{Ftau} и ~\eqref{omegaboundary} получим 
\begin{equation}\label{solutionbroken} 
    u_{2jn} = \tau y_{jn}\sqrt {|ab|} =   
        \tau y_{jn}  \sqrt{\frac{|ab|}{F(\tau)}} \frac{1}{2\sin\omega} =
        \sqrt{\frac{|ab|}{F(\tau)}} \frac{y_{jn}}{2}\, u_2.
\end{equation}  
Если $|ab|<F(\tau)$, то неравенства $y_{jn}<2$ (см. Лемму 1) из
\eqref{solutionbroken} вытекает $|u_{2jn}|<|u_2|$,  поэтому все точки  $M_{jn}$
лежат внутри конуса устойчивости, следовательно, система    
\eqref{matrixbrokenequ},~\eqref{matrixbroken} устойчива при всех  $n$.
 
Пусть $|ab|>F(\tau)$. Тогда по Лемме 1 найдется такое значение $n_{0}$, что при
любом $n>n_0$ 
\begin{equation}\label{finalbroken} 
    y_{nn}>2\sqrt{\frac{F(\tau)}{|ab|}},
\end{equation} 
откуда следует $u_{nn}>u_2$. Это значит, что точка $M_{nn}$ находится вне конуса
устойчивости, что влечет неустойчивость системы~\eqref{matrixbrokenequ},
\eqref{matrixbroken} устойчива при всех  $n$.
  
Теорема  3 доказана.


\section{Дискуссия}\label{sec:discussion}

Как выясняется в разделе~\ref{sec:mainresults}   этой заметки, для обеспечения
устойчивости нейронной сети круговой конфигурации имеются два пути. Первый -
уменьшать интенсивности взаимодействия нейронов с двумя соседними - то есть
обеспечивать неравенство $|a|+|b|<1$. Это обеспечит delay-independent stability.
Если недоступен первый способ, то следует обеспечить разные знаки интенсивности
воздействия на каждый нейрон справа и слева (то есть разные знаки чисел $a,b$) и
дополнительно обеспечить близость абсолютных величин $a,b$, то есть обеспечить  
неравенство  $|a+b|<1$ , чтобы  при не слишком больших значениях запаздывания
войти в область $D_{\tau}$, описанную в разделе 2.

При разрыве кольца   система связей нейронов становится линейной. Область
устойчивости в линейной системе шире, чем в кольцевой. Повидимому, возмущение
легче затухает в линейной системе. 

В будущих работах мы планируем исследования устойчивости других стандартных
конфигураций нейронов, таких как двух- и трехслойные конфигурации.

%Остановимся на этом моменте. Условно изолированный нейрон без внешнего
% воздействия можно преставить апериодическим звеном с постоянной времени $T$,
% описываемым уравнением   
%\begin{equation}\label{aperiodicchain}
%T \dot{x}(t) +  x(t)  = 0.  
%\end{equation}
 




  
  

